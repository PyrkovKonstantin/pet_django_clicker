{% extends 'clicker/base.html' %}

{% block title %}–ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π –±–æ–Ω—É—Å - Hamster Combat{% endblock %}

{% block content %}
<h2>–ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π –±–æ–Ω—É—Å</h2>

<div class="daily-calendar">
    {% for day in reward_days %}
    <div class="day day-{{ day.status }}" data-day="{{ day.day }}">
        {% if day.status == 'claimed' %}
        üéÅ
        {% else %}
        {{ day.day }}
        {% endif %}
    </div>
    {% endfor %}
</div>

{% for day in reward_days %}
    {% if day.status == 'available' %}
    <form id="claim-reward-form" method="post" action="{% url 'clicker:claim_daily_reward' %}">
        {% csrf_token %}
        <button type="submit" class="btn btn-claim">–ü–æ–ª—É—á–∏—Ç—å –Ω–∞–≥—Ä–∞–¥—É –∑–∞ –¥–µ–Ω—å {{ day.day }}</button>
    </form>
    {% endif %}
{% endfor %}
{% endblock %}

{% block scripts %}
<script>
    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –¥–ª—è —Ñ–æ—Ä–º—ã –ø–æ–ª—É—á–µ–Ω–∏—è –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–π –Ω–∞–≥—Ä–∞–¥—ã
    const claimForm = document.getElementById('claim-reward-form');
    if (claimForm) {
        claimForm.addEventListener('submit', function(e) {
            e.preventDefault();
            
            // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∑–∞–ø—Ä–æ—Å –Ω–∞ –ø–æ–ª—É—á–µ–Ω–∏–µ –Ω–∞–≥—Ä–∞–¥—ã
            sendPostRequest(this.action, {}, function(data) {
                // –û–±–Ω–æ–≤–ª—è–µ–º –±–∞–ª–∞–Ω—Å
                updateBalance(data.new_balance);
                
                // –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∑–¥–µ—Å—å –Ω—É–∂–Ω–æ –æ–±–Ω–æ–≤–∏—Ç—å –∫–∞–ª–µ–Ω–¥–∞—Ä—å –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ
                // –ü–æ–∫–∞ –ø—Ä–æ—Å—Ç–æ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º —Å—Ç—Ä–∞–Ω–∏—Ü—É –¥–ª—è –ø—Ä–æ—Å—Ç–æ—Ç—ã
                location.reload();
            });
        });
    }
</script>
{% endblock %}